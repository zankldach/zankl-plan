<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>{% block title %}Zankl Plan{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="/static/style.v2.css">

  <style>
    :root { --blue:#003a8f; --bg:#f4f6f8; }
    body {
      margin:0;
      font-family: Arial, sans-serif;
      background: var(--bg);
      color:#0f172a;
    }

    header.site {
      background: var(--blue);
      color:#fff;
      padding:10px 20px;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }

    nav.site {
      background: var(--blue);
      padding:6px 20px;
      display:flex;
      gap:12px;
      align-items:center;
      flex-wrap:wrap;
    }

    nav.site a {
      color:#fff;
      text-decoration:none;
      font-weight:600;
      padding:6px 10px;
      border-radius:6px;
    }
    nav.site a:hover { background: rgba(255,255,255,0.15); }
    nav.site a.is-active { background: rgba(255,255,255,0.25); }

    nav.site .sep {
      width:1px;
      height:22px;
      background: rgba(255,255,255,0.35);
      margin:0 4px;
    }

    main { padding:20px; }
  </style>

  {% block head %}{% endblock %}
</head>
<body>

<header class="site">
  <strong>Zankl-Plan</strong>

  <div>
    {% set u = request.session.get("user") %}
    {% if u %}
      <span style="margin-right:10px;">ðŸ‘¤ {{ u.username }}</span>
      <a href="/logout" style="color:white;">Logout</a>
    {% endif %}
  </div>
</header>

<nav class="site">

  {% set u = request.session.get("user") %}

  {% if u %}

    <!-- ================= WRITE / ADMIN ================= -->
    {% if u.is_write %}

      <!-- Arbeitsansicht -->
      <a href="/week?standort=engelbrechts">Engelbrechts</a>
      <a href="/week?standort=gross-gerungs">GroÃŸ Gerungs</a>

      <span class="sep"></span>

      <!-- Viewer -->
      <a href="/view/week?standort=engelbrechts">View EB</a>
      <a href="/view/week?standort=gross-gerungs">View GG</a>

      <span class="sep"></span>

      <!-- Einstellungen -->
      <a href="/settings/employees">Mitarbeiter</a>
      <a href="/settings/users">Benutzer</a>

    <!-- ================= VIEWER ================= -->
    {% else %}

      {% if u.can_view_eb %}
        <a href="/view/week?standort=engelbrechts">View EB</a>
      {% endif %}

      {% if u.can_view_gg %}
        <a href="/view/week?standort=gross-gerungs">View GG</a>
      {% endif %}

    {% endif %}

    <span class="sep"></span>

    <a href="/bedienung">Bedienung</a>

  {% endif %}

</nav>

<main>
  {% block content %}{% endblock %}
</main>

<script>
  const path = window.location.pathname;
  document.querySelectorAll('nav.site a').forEach(a => {
    if (path === new URL(a.href).pathname) {
      a.classList.add('is-active');
    }
  });
</script>

{% block scripts %}{% endblock %}
</body>
</html>
