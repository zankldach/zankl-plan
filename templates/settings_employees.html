{% extends "base.html" %}
{% block title %}Mitarbeiter Â· Einstellungen{% endblock %}

{% block content %}
<h1>Mitarbeiter verwalten</h1>

<form method="get" action="/settings/employees" style="margin-bottom:12px;">
  <label>
    Standort:
    <select name="standort" onchange="this.form.submit()">
      <option value="engelbrechts" {{ 'selected' if standort=='engelbrechts' else '' }}>Engelbrechts</option>
      <option value="gross-gerungs" {{ 'selected' if standort=='gross-gerungs' else '' }}>GroÃŸ Gerungs</option>
    </select>
  </label>
</form>

{% if saved %}
<div style="background:#e7ffe7;padding:8px;margin-bottom:10px;">
  Gespeichert.
</div>
{% endif %}

<table class="table" style="margin-bottom:16px;">
  <thead>
    <tr>
      <th style="width:60px;">ID</th>
      <th>Name</th>
      <th style="width:60px;"></th>
    </tr>
  </thead>
  <tbody>
    {% for e in employees %}
    <tr>
      <td>{{ e.id }}</td>
      <td>
        <input type="text" value="{{ e.name }}" disabled style="width:100%;">
      </td>
      <td>
        <form method="post" action="/settings/employees/delete"
              onsubmit="return confirm('Mitarbeiter wirklich lÃ¶schen?');">
          <input type="hidden" name="emp_id" value="{{ e.id }}">
          <button type="submit">ğŸ—‘ï¸</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<form method="post" action="/settings/employees">
  <input type="hidden" name="standort" value="{{ standort }}">

  <fieldset style="padding:10px;">
    <legend>Neue Mitarbeiter</legend>

    <div id="rows"></div>

    <button type="button" id="add">+ Zeile</button>
    <button type="submit">Speichern</button>
  </fieldset>
</form>
{% endblock %}

{% block scripts %}
<script>
const wrap = document.getElementById('rows');
const add = document.getElementById('add');

function addRow() {
  const d = document.createElement('div');
  d.innerHTML = `<input name="emp_name_new[]" style="width:240px;">`;
  wrap.appendChild(d);
}

add.addEventListener('click', addRow);
addRow();
</script>
{% endblock %}
